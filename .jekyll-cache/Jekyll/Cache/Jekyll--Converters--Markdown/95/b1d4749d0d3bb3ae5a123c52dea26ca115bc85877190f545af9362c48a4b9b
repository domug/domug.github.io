I"-<p><a href="https://domug.github.io/2022/04/25/ABTest_5/">저번 포스트</a>에서는 실험의 결과를 도출하는 과정에서 발생할 수 있는 <strong>다중 검정</strong>의 개념을 정의한 다음, 이를 처리할 수 있는 몇가지 통계적 접근법들에 대해서 살펴보았다. 해당 내용의 연장선상에서, 이번에는 구체적으로 어떠한 경우에 다중 검정에 대한 유의 수준 보정이 필요한지를 정리해보도록 하겠다.</p>

<p>앞서 다중 검정은 그 개념 자체가 다소 생소하기 때문에 A/B Test와 관련한 실무자들에게 그 위험성 자체가 인지되지 않는 경우가 많다는 점을 언급한 적이 있다. 그리고 실제로 optimizely, facebook ads 등의 실험 플랫폼 등에서도 구체적인 p-value를 제시하기 보다는 최종적인 결과 (통계적으로 유의하다 / 유의하지 않다) 만을 UI 상에서 제시하기 때문에, 구체적으로 어떠한 부분에서 다중 검정으로 인한 유의 수준이 보정되는지를 파악하기가 다소 어렵다.</p>

<p>이러한 측면에서 A/B Test를 설계 및 진행함에 있어 어떠한 측면에서 어떻게 다중 검정의 이슈를 핸들링할 수 있는지를 개괄적으로 정리해보려고 한다. 구체적으로 다룰 내용은 다음과 같다:</p>

<ul>
  <li><strong>평가 지표의 분류</strong></li>
  <li><strong>하위군 분석 (Segment Analysis)</strong></li>
  <li><strong>A/B/n 실험</strong></li>
  <li><strong>조기 종료 (Early Stopping)</strong></li>
</ul>

<p> </p>

<hr />

<h1 id="1-평가-지표의-분류">1. 평가 지표의 분류</h1>

<p>이전에 살펴본 Bonferroni 등의 방법을 사용해서 다중검정 문제를 해결하려는 경우, 필연적으로 우리는 더 <strong>낮은 유의수준</strong>에서 가설 검정을 진행하게 된다. 이에 따라 결과적으로 실험의 유의성을 주장하기 위해서는 더 유의한 (낮은) p-value가 요구되기 때문에 실험의 <strong>검정력</strong>을 손해보는 상황이 발생한다.</p>

<p>위와 같은 이유로 Bonferroni 등의 방법은 정말 필요할 때만, <strong>최소한</strong>으로 적용하는 것이 바람직할 것이다. 무분별하게 적용할 경우면 실제로 유의했던 실험들이 기각되는 오류가 발생할 수 있기 때문이다. 이러한 맥락에서 각 지표들의 특징을 바탕으로, 해당 지표가 실험의</p>

<p>지표별로 다중 검정에 대한 유의수준 보정이 필요한 상황을 간단하게 정리하도록 하겠다.</p>

<p> </p>

<h4 id="1차-유효성-평가변수-primary-metric">1차 유효성 평가변수 (Primary Metric)</h4>

<p>OEC와 같이 실험을 통해 <strong>인과성을 검증하고자 하는 메인 지표</strong>를 의미한다.</p>

<p>이러한 지표들에 대해서 만큼은 1종 오류가 실험의 계획단계에서 고려된 유의수준보다 절대로 증가해서는 안될 것이다.</p>

<p>보통의 A/B Test에서 1차 유효성 평가변수는 단 한개만 설정되는 것이 일반적이나, 만약 후술할 2차 유효성 평가변수 등에 대한 확증적 결과를 얻으려는 경우 앞서 살펴본 방법론들을 바탕으로 함께 유의수준을 보정해야 할 필요가 있다.</p>

<p> </p>

<h4 id="2차-유효성-평가변수-secondary-metric">2차 유효성 평가변수 (Secondary Metric)</h4>

<p>2차 유효성 평가변수란, 1차 유효성 평가변수에 비해서는 중요도가 떨어지지만 그럼에도 불구하고 관심있게 체크하고 싶은 지표를 의미한다.</p>

<p>일반적으로 이러한 2차 유효성 평가변수에 대해서는 <strong>유의수준을 보정하지 않는 것이 원칙</strong>이나, 그럼에도 불구하고 실험의 유의성을 판단함에 있어 직접적인 고려대상이 되는 경우에는 다중 검정을 보정해야 한다.</p>

<p> </p>

<h4 id="보조-지표-debugging--guardrail-metric">보조 지표 (Debugging &amp; Guardrail Metric)</h4>

<p>Guardrail metric 등의 보조 지표에 대해서는 <strong>유의수준을 보정할 필요가 없다</strong>.</p>

<p>해당 지표들은 실험의 유의성을 판단하는데 있어 직접적인 영향을 미치지 않는, 어디까지나 “부수적인” 지표이기 때문에 1종 오류의 증가에 민감하게 대응할 필요가 없다. 그렇기 때문에 이러한 지표들에 대한 결과는 어디까지나 참고용으로만 활용해야 한다.</p>

<p> </p>

<h4 id="segment-analysis">Segment Analysis</h4>

<p>많은 경우, 진행된 실험의 모집단에서 하위군 (subgroup) 별로 결과를 파악하고 싶은 경우가 발생할 수 있다. 이러한 상황에서는 유의수준을 보정하지 않는 것을 원칙으로 하되, 실험의 결과를 인과적으로 받아들이지 않는 것에 대한 각별한 주의가 필요하다.</p>

<p>가령, 하위군 분석의 결과로 새로운 기능이 여성 그룹에서는 유의하지 않고 남성 그룹에서만 유의했을 경우, 해당 결과는 어디까지나 인사이트를 얻기 위한 참고 자료로만 활용되어야 한다. 만약 실제로 성별에 따라 효과에 차이가 있는지에 관심이 있는 경우에는 primary metric을 성별별 지표로 삼는 별도의 follow-up experiment를 진행해야 한다.</p>
:ET